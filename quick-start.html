
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="index.html" rel="prev"/>
<link href="assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.18" name="generator"/>
<title>Quick start - Tesla Smart Charger Docs</title>
<link href="assets/stylesheets/main.7e37652d.min.css" rel="stylesheet"/>
<link href="assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#quick-start">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Tesla Smart Charger Docs" class="md-header__button md-logo" data-md-component="logo" href="index.html" title="Tesla Smart Charger Docs">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Tesla Smart Charger Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Quick start
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/codesquadnest/tesla-smart-charger" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4" fill="currentColor"></path></svg>
</div>
<div class="md-source__repository">
    codesquadnest/tesla-smart-charger
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="index.html">
        
  
  
    
  
  Tesla Smart Charger Documentation

      </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="quick-start.html">
        
  
  
    
  
  Quick start

      </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Tesla Smart Charger Docs" class="md-nav__button md-logo" data-md-component="logo" href="index.html" title="Tesla Smart Charger Docs">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Tesla Smart Charger Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/codesquadnest/tesla-smart-charger" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4" fill="currentColor"></path></svg>
</div>
<div class="md-source__repository">
    codesquadnest/tesla-smart-charger
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="index.html">
<span class="md-ellipsis">
    Tesla Smart Charger Documentation
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Quick start
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="quick-start.html">
<span class="md-ellipsis">
    Quick start
    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites">
<span class="md-ellipsis">
      Prerequisites
    </span>
</a>
<nav aria-label="Prerequisites" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#tesla-fleet-api-access">
<span class="md-ellipsis">
      Tesla Fleet API access
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setup-tesla-application">
<span class="md-ellipsis">
      Setup tesla application
    </span>
</a>
<nav aria-label="Setup tesla application" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#option-2-use-the-docker-image-use-this-if-you-dont-have-go-installed">
<span class="md-ellipsis">
      Option 2: Use the Docker image (use this if you don't have Go installed)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#configuration">
<span class="md-ellipsis">
      Configuration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#execution">
<span class="md-ellipsis">
      Execution
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#shutdown">
<span class="md-ellipsis">
      Shutdown
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="quick-start">Quick start</h1>
<p>This guide will help you get started with the Tesla Smart Charger.</p>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>Home server or Raspberry Pi with Git and Docker installed.</li>
<li>Shelly EM (any equivalent energy monitor can be compatible with proper adaptations).</li>
<li>Webserver like Nginx or Apache where you can host the public key and the callback URL.</li>
<li>Tesla developer account.</li>
<li>Tesla application.</li>
<li>Tesla vehicle.</li>
</ul>
<h3 id="tesla-fleet-api-access">Tesla Fleet API access</h3>
<p>Although the official documentation is available on the <a href="https://developer.tesla.com/docs/fleet-api/getting-started/what-is-fleet-api">Tesla API documentation</a>,
this guide will the steps to setup the required authentication and configuration to
use the tesla-smart-charger.</p>
<h3 id="setup-tesla-application">Setup tesla application</h3>
<p>These instructions are based on the official <a href="https://developer.tesla.com/docs/fleet-api/getting-started/what-is-fleet-api">Tesla API documentation</a>.  </p>
<ul>
<li>Go to <a href="https://developer.tesla.com">Tesla Developer</a> website.  </li>
<li>Login with your Tesla account.  </li>
<li>Create a new application:<br/>
Fill the required fields.
Add your hostname where the public key and callback URL will be hosted.<br/>
Add the callback URL. The callback URL should be in the format <code>https://&lt;hostname&gt;/callback</code> (e.g. <code>https://example.com/done.html</code>).<br/>
Copy the client ID and client secret. You will need these to authenticate the tesla-smart-charger.  </li>
<li>Generate the private and public keys:<br/>
Go to the <a href="https://github.com/teslamotors/vehicle-command">Tesla Vehicle Command</a> repository.<br/>
Use the tesla-keygen tool to generate the private and public keys:<br/>
The public key should be hosted on the webserver.  </li>
</ul>
<p><strong>Option 1: Build and use tesla-keygen tool (use this if you have Go installed)</strong> </p>
<pre><code class="language-bash">git clone https://github.com/teslamotors/vehicle-command.git
cd vehicle-command/cmd/tesla-keygen
go get ./...
go build ./...
./tesla-keygen -key-file private-key.pem -keyring-type file -output public-key.pem create
</code></pre>
<h4 id="option-2-use-the-docker-image-use-this-if-you-dont-have-go-installed">Option 2: Use the Docker image (use this if you don't have Go installed)</h4>
<pre><code class="language-bash">docker build -f Dockerfile.tesla-keygen -t tesla-keygen:latest .
docker run --rm -v $PWD/certs:/app/certs --name tesla-keygen tesla-keygen:latest
# Ensure the current user has proper access to the generated files
# Note: Use an appropriate method for your system to change file ownership
sudo chown $USER:$USER certs/* # On systems with sudo
# OR
chown $(id -u):$(id -g) certs/* # On systems without sudo, when run as root
</code></pre>
<div class="mermaid">sequenceDiagram
    participant User
    participant Docker
    participant KeyGen

    User-&gt;&gt;Docker: Build Docker Image
    Docker-&gt;&gt;KeyGen: Execute tesla-keygen
    KeyGen--&gt;&gt;Docker: Generate Public Key
    Docker--&gt;&gt;User: Output Public Key
    User-&gt;&gt;User: Change Ownership of Generated Files
    Note right of User: Ensures proper file access
</div>
<blockquote>
<p><a href="https://developer-domain.com/.well-known/appspecific/com.tesla.3p.public-key.pem">https://developer-domain.com/.well-known/appspecific/com.tesla.3p.public-key.pem</a></p>
</blockquote>
<ul>
<li>Register the public key with the Tesla application
In a web browser, go to the following URL:  </li>
</ul>
<blockquote>
<p><a href="https://fleet-auth.prd.vn.cloud.tesla.com/oauth2/v3/authorize?&amp;client_id=$CLIENT_ID&amp;locale=en-US&amp;prompt=login&amp;redirect_uri=$CALLBACK_URL&amp;response_type=code&amp;scope=openid%20vehicle_device_data%20offline_access%20vehicle_cmds%20vehicle_charging_cmds&amp;state=db4af3f87">Tesla OAuth Authorization</a></p>
</blockquote>
<p><strong>Note:</strong> Replace the <code>$CLIENT_ID</code> and <code>$CALLBACK_URL</code> with the values from the Tesla application.  </p>
<p>Login with your Tesla account.<br/>
Copy the code from the URL and use it to register the public key:</p>
<pre><code class="language-bash">CLIENT_ID=$CLIENT_ID
CLIENT_SECRET=$CLIENT_SECRET
AUDIENCE="https://fleet-api.prd.eu.vn.cloud.tesla.com"
CODE=$CODE
# Partner authentication token request
curl --request POST \
--header 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'grant_type=client_credentials' \
--data-urlencode "client_id=$CLIENT_ID" \
--data-urlencode "client_secret=$CLIENT_SECRET" \
--data-urlencode 'scope=openid offline_access user_data vehicle_device_data vehicle_cmds vehicle_charging_cmds' \
--data-urlencode "audience=$AUDIENCE" \
'https://fleet-auth.prd.vn.cloud.tesla.com/oauth2/v3/token'
</code></pre>
<p>Copy the access token from the response and use it to register the public key:</p>
<pre><code class="language-bash">export TESLA_AUTH_TOKEN=$TOKEN
curl -H "Authorization: Bearer $TESLA_AUTH_TOKEN" \
    -H 'Content-Type: application/json' \
    --data '{
            "domain": "https://example.com",
        }' \
    -X POST \
    -i https://fleet-api.prd.eu.vn.cloud.tesla.com/api/1/partner_accounts
</code></pre>
<p>The public key should be registered with the Tesla application.</p>
<ul>
<li>Generate a self-signed certificate  </li>
</ul>
<p>Generate a self-signed certificate for tesla-http-proxy:</p>
<pre><code class="language-bash">export HTTPS_PROXY=127.0.0.1 # The IP address of the host machine.
openssl req -x509 -nodes -newkey ec \
    -pkeyopt ec_paramgen_curve:secp521r1 \
    -pkeyopt ec_param_enc:named_curve \
    -subj '/CN=localhost' \
    -keyout tls-key.pem -out tls-cert.pem -sha256 -days 3650 \
    -addext "subjectAltName = DNS:localhost, IP:$HTTPS_PROXY" \
    -addext "extendedKeyUsage = serverAuth" \
    -addext "keyUsage = digitalSignature, keyCertSign, keyAgreement"
</code></pre>
<ul>
<li>Start the tesla-http-proxy</li>
</ul>
<p>The tesla-http-proxy is a reverse proxy that will forward the requests to the Tesla API.<br/>
Start the tesla-http-proxy:  </p>
<pre><code class="language-bash">cd vehicle-command/cmd/tesla-http-proxy
go build ./...
# Copy cert.pem, key.pem, and private-key.pem to the same directory.
./tesla-http-proxy -tls-key tls-key.pem -cert tls-cert.pem -port 4443 -key-file private-key.pem -verbose
</code></pre>
<p>The tesla-http-proxy should be running on port 4443.</p>
<ul>
<li>Generate an OAuth token<br/>
The OAuth token creation is also based on the official <a href="https://developer.tesla.com/docs/fleet-api/authentication/third-party-tokens">Tesla Fleet API documentation</a>:</li>
</ul>
<pre><code class="language-bash"># Authorization code token request
CLIENT_ID=$CLIENT_ID
CLIENT_SECRET=$CLIENT_SECRET
AUDIENCE="https://fleet-api.prd.eu.vn.cloud.tesla.com"
CODE=$CODE # The code generated in step 5 or generate a new code using the same URL.
CALLBACK="https://example.com/done.html"
curl --request POST \
--header 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'grant_type=authorization_code' \
--data-urlencode "client_id=$CLIENT_ID" \
--data-urlencode "client_secret=$CLIENT_SECRET" \
--data-urlencode "code=$CODE" \
--data-urlencode "audience=$AUDIENCE" \
--data-urlencode "redirect_uri=$CALLBACK" \
'https://fleet-auth.prd.vn.cloud.tesla.com/oauth2/v3/token'
# Extract access_token and refresh_token from this response
</code></pre>
<p>The access token and refresh token should be used to authenticate the tesla-smart-charger.<br/>
Refresh token expires in 3 months, to get a new refresh token, use the following command:  </p>
<pre><code class="language-bash"># Refresh token request
export REFRESH_TOKEN=$REFRESH_TOKEN
export CLIENT_ID=$CLIENT_ID
curl --request POST \
--header 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'grant_type=refresh_token' \
--data-urlencode "client_id=$CLIENT_ID" \
--data-urlencode "refresh_token=$REFRESH_TOKEN" \
'https://fleet-auth.prd.vn.cloud.tesla.com/oauth2/v3/token'
</code></pre>
<ul>
<li>The Tesla application is now setup and ready to be tested with the tesla-http-proxy<br/>
Test the Tesla application with the tesla-http-proxy:</li>
</ul>
<pre><code class="language-bash">export TESLA_AUTH_TOKEN=$access_token
export VIN=$VIN
curl --cacert tls-cert.pem \
    --header "Authorization: Bearer $TESLA_AUTH_TOKEN" \
    "https://localhost:4443/api/1/vehicles/$VIN/vehicle_data" \
    | jq -r .

# The response should be the vehicle data.
</code></pre>
<blockquote>
<p>The Tesla application is now setup and ready to be used with the tesla-smart-charger.</p>
</blockquote>
<h3 id="configuration">Configuration</h3>
<p>From the previous steps, you should have the following information:</p>
<ul>
<li><code>client_id</code></li>
<li><code>client_secret</code></li>
<li><code>public_key.pem</code></li>
<li><code>private_key.pem</code></li>
<li><code>access_token</code></li>
<li><code>refresh_token</code></li>
<li><code>VIN</code></li>
</ul>
<p>Fill the configuration <code>config.json</code> with your specific values:</p>
<ul>
<li><code>homeMaxAmps</code>: Available power in amps that is available for the house.</li>
<li><code>chargerMaxAmps</code>: Maximum power in amps that the charger can use.</li>
<li><code>chargerMinAmps</code>: Minimum power in amps that the charger can use.</li>
<li><code>downStepPercentage</code>: Percentage of power reduction when overload is detected.</li>
<li><code>upStepPercentage</code>: Percentage of power increase when overload is not detected.</li>
<li><code>sleepTimeSecs</code>: Time in seconds between each check after overload is detected.</li>
<li><code>energyMonitorIp</code>: IP address or hostname of the Energy Monitor.</li>
<li><code>energyMonitorType</code>: Type of Energy Monitor. Currently only <code>shelly-em</code> is supported.</li>
<li><code>hostIp</code>: IP address of the host machine. This is used to send overload notifications to the Energy Monitor thread.</li>
<li><code>apiPort</code>: Port where the Tesla Smart Charger API will be exposed.</li>
<li><code>teslaVehicleId</code>: Vehicle ID obtained from the Tesla API.</li>
<li><code>teslaAccessToken</code>: Access token obtained from the Tesla API.</li>
<li><code>teslaRefreshToken</code>: Refresh token obtained from the Tesla API.</li>
<li><code>teslaHttpProxy</code>: HTTP proxy to use when connecting to the Tesla API.</li>
<li><code>teslaClientId</code>: Client ID obtained from the Tesla API.</li>
</ul>
<p>The configuration file is located at <code>config.json</code> and should look like this:</p>
<pre><code class="language-json">{
  "homeMaxAmps": 30.0,
  "chargerMaxAmps": 25.0,
  "chargerMinAmps": 6.0,
  "downStepPercentage": 0.5,
  "upStepPercentage": 0.25,
  "sleepTimeSecs": 30,
  "energyMonitorIp": "ip-or-hostname",
  "energyMonitorType": "shelly-em",
  "hostIp": "ip-address",
  "apiPort": 8000,
  "teslaVehicleId": "12345678901234567",
  "teslaAccessToken": "12345678901234567",
  "teslaRefreshToken": "12345678901234567",
  "teslaHttpProxy": "http://localhost:4443",
  "teslaClientId": "12345678901234567"
}
</code></pre>
<p><strong>Note 1:</strong> When assigning a different port, make sure to update the <code>Dockerfile</code> and set the <code>apiPort</code> port in <code>config.json</code> to the same value.</p>
<p><strong>Note 2:</strong> If you choose to copy the certificates to a different location, make sure to update the <code>Dockerfile.tesla-smart-charger</code> and set the environment <code>TESLA_CERTS_DIR</code> to the same value.</p>
<h3 id="execution">Execution</h3>
<p>Run the Tesla Smart Charger:</p>
<pre><code class="language-bash">docker compose up --build -d
</code></pre>
<p>To test your configuration you can call (GET) <code>http://&lt;tesla-smart-charger-ip&gt;:&lt;port&gt;/config</code></p>
<p>Another way to test the configuration is accessing <code>http://&lt;tesla-smart-charger-ip&gt;:&lt;port&gt;</code> in a web browser. You should see the configuration values which can be updated and there is also an option to fetch
the list of overloads detected.</p>
<p>The default behavior, with no extra configuration, is that the charging amps will be reduced by the <code>downStepPercentage</code> configuration. For example, if <code>downStepPercentage</code> is set to 0.5, the charging amps will be configured to half of the current amps. If it's set to 0.25, it will be configured to 25% of the current amps.</p>
<h3 id="shutdown">Shutdown</h3>
<p>To stop the Tesla Smart Charger:</p>
<pre><code class="language-bash">docker compose down
</code></pre>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.path", "navigation.instant", "navigation.top", "toc.integrate"], "search": "assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="assets/javascripts/bundle.92b07e13.min.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
mermaid.initialize({});</script></body>
</html>